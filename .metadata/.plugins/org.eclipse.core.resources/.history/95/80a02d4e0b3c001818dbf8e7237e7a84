#include "I2C.h"


void EEPROM_Init(){
	I2C_Init();
}

int EEPROM_Write(char * buffer, int length){
	if(state == I2C_STARTED)
		return 0; //busy
	if(length > I2C_BUFFER_SIZE - 1)
		return -1; // buffer to big

	Wrbuffer[0] = (0x1010) << 4;
	for(int i = 1; i < lenght; i++)
		Wrbuffer[i] = buffer[i];

	WrLength = length;

	I2C_Start();
}

int EEPROM_Read(char buffer [64], int numberOfBytes){
	if(state == I2C_STARTED)
		return 0; //busy

	Wrbuffer[0] = ((0x1010) << 4) | 1;
	RrLength = length;

	I2C_Start();

	while(state == I2C_STARTED)
		__WFI();

	for(int i = 0; i < numberOfBytes; i++)
		buffer[i] = Rdbuffer[i];

	return 0; //ok
}
